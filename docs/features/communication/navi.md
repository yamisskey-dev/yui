# 人生相談(Navi) [[navi]]

## 概要
- 外部のNaviサーバーと連携して、高度な人生相談・カウンセリング機能を提供
- 感情分析、セッション管理、クライシス検出機能を搭載
- ユーザーごとのプロファイル設定とカスタムプロンプト対応

## コード定義
- メイン実装: `src/modules/navi/index.ts`
- 設定: `config.json`の`naviApiUrl`、`naviDebugMode`、`naviTimeoutNotification`

## コードでの扱い方
- `mentionHook`で「navi」コマンドに反応
- 外部APIサーバーと通信してカウンセリング機能を提供
- ユーザーセッション管理とプロファイル設定を永続化

## 使い方・拡張方法
### 基本的な相談
```
@ai navi 最近仕事がうまくいかなくて悩んでいます
```

### 管理者向けコマンド
- プロンプト一覧表示
- サーバー状態確認
- 統計情報取得

### 設定項目
- `naviApiUrl`: Naviサーバーのエンドポイント
- `naviDebugMode`: デバッグ情報の表示
- `naviTimeoutNotification`: タイムアウト通知の有効化

## 主な機能
- **感情分析**: メッセージから感情状態を分析
- **クライシス検出**: 危険な状態を自動検出
- **セッション管理**: ユーザーごとの対話履歴を保持
- **カスタムプロンプト**: 相談内容に応じた専門的な応答
- **フォローアップ**: 継続的なサポート提案

## 関連・連携
- [[features/communication/aichat.md]]（AIチャットとの違い・住み分け）
- [[features/communication/talk.md]]（基本会話機能との連携）
- [[features/core/core.md]]（モジュール管理・基本応答）

## TODO・改善点
- [ ] セッション情報の永続化実装（現在はメモリ内のみ）
- [ ] より詳細なエラーハンドリングとリトライ機能
- [ ] ユーザープロファイル設定のGUI化
- [ ] 感情分析結果の履歴表示機能
- [ ] カスタムプロンプトの動的作成機能

---

運用・開発Tipsは [[development.md]] を参照。